pkgname=linuxcnc
pkgver=2.7.7
pkgrel=1
pkgdesc="A software system for computer control of machine tools."
arch=('i686' 'x86_64')
license=('GPL2')
curl="http://linuxcnc.org/"
#depends=('bc' 'bwidget' 'tcl' 'tk' 'xorg-server' 'python2-libgnome' 'python2-imaging' 'tkimg' 'python2-gtkglext' 'tclx' 'boost' 'boost-libs')
install=$pkgname.install
source=('linuxcnc-2.7.7.tar.gz')
md5sums=('SKIP');
makedepends=('git')

build () {
  find . -iname fixpaths.py -o -iname checkglade|xargs perl -p -i -e "s/python/python2/"
  cd $srcdir/$pkgname-$pkgver/src
  pwd
  ./autogen.sh
  ./configure --with-realtime=uspace --with-python=/usr/bin/python2.7 --without-libusb-1.0 --without-libmodbus --prefix=/usr --enable-non-distributable=yes || return 1

  make || return 1
}

package() {
  cd $srcdir/$pkgname-$pkgver/src
  make install DESTDIR=${pkgdir} || return 1
  #Fix lsmod
  #sed -i 's/sbin/bin/g' $pkgdir/etc/init.d/realtime

  #Stop hiding it from GNOME
#  cp -PR $srcdir/linuxcnc/share/applications $pkgdir/usr/share/

  #mkdir -p $pkgdir/etc/xdg
  #cp -PR $srcdir/linuxcnc/share/menus $pkgdir/etc/xdg/
}

